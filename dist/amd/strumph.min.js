/**
 * password-strumph.js - v0.1.0 
 * Copyright (c) 2013 Uglymunky
 * 
 * Refactored from jQuery validate.password plug-in 1.0
 * Original Copyright (c) 2009 JÃ¶rn Zaefferer
 * 
 * Dual licensed under the MIT and GPL licenses:
 * http://www.opensource.org/licenses/mit-license.php
 * http://www.gnu.org/licenses/gpl.html
 */
define(["jquery"],function(a){"use strict";function b(a){return a.substring(0,1).toLowerCase()+a.substring(1)}function c(b){var c,e=a(b.el);if(!e)throw'Missing "el"';return c=new d(b),e.keyup(function(a){c.checkPassword(a.target.value)}),c}function d(b){var c=a.extend({},d.defaults,b),e=a(c.target).html(c.template);this.$meter=a(c.meter,e),this.$message=a(c.message,e),this.messages=c.messages}var e=/[a-z]/,f=/[A-Z]/,g=/[0-9]/,h=/[0-9].*[0-9]/,i=/[^a-zA-Z0-9]/,j=/^(.)\1+$/;return d.defaults={template:'<div class="strumph-meter"><div class="strumph-meter-message"></div><div class="strumph-meter-bg"><div class="strumph-meter-bar"></div></div></div>',meter:".strumph-meter",message:".strumph-meter-message",target:".password-strumph",messages:{"too-short":"Too short","very-weak":"Very weak",weak:"Weak",good:"Good",strong:"Strong"}},d.prototype.checkPassword=function(a){var b=this.rate(a);return this.updateMeter(b),b.rate>2},d.prototype.updateMeter=function(a){this.$meter.removeClass().addClass("strumph-meter").addClass("strumph-meter-"+a.messageKey),this.$message.text(this.messages[a.messageKey])},d.prototype.rating=function(a,b){return{rate:a,messageKey:b}},d.prototype.rate=function(a){if(!a||a.length<8)return this.rating(0,"too-short");if(j.test(a))return this.rating(1,"very-weak");var c=e.test(a),d=f.test(b(a)),k=g.test(a),l=h.test(a),m=i.test(a);return c&&d&&k||c&&l||d&&l||m?this.rating(4,"strong"):c&&d||c&&k||d&&k?this.rating(3,"good"):this.rating(2,"weak")},c});